import{A as e,_ as t,a,p as s,b as i,r as l,c as o,o as r,d as n,e as c,t as d,w as h,v as u,T as m,F as p,f,g as w,h as y,i as b,j as v,k as g,l as R}from"./vendor.e72ed981.js";e.init({appId:"KevHy7qQ0PeY5LE99d5sRelK-MdYXbMMI",appKey:"LzabiOqIPn3hDLdwkYDjQ9s5",serverURL:"https://kevhy7qq.api.lncldglobal.com"});var V=async()=>{const t=new e.Query("TopList");return(await t.find()).map((e=>({id:e.id,playerName:e.attributes.playerName,record:e.attributes.record,isShuffle:e.attributes.isShuffle,createDate:e.attributes.createDate})))},T=async t=>{const a=new(e.Object.extend("TopList"));for(let e in t)a.set(e.toString(),t[e]);try{return{code:200,id:(await a.save()).id}}catch(s){return{code:500,err:s}}},x=async(t,a)=>{const s=e.Object.createWithoutData("TopList",t.toString());s.set("record",parseFloat(a));try{return{code:200,id:(await s.save()).id}}catch(i){return{code:500,err:i}}};const S={name:"App",data:()=>({inputVal:"",isShuffle:!1,curr:"",index:"",isLast:"",alpha:"",timer:"",showTime:0,startTime:"",records:[],rotate:!1,date:"",newRecVisible:!1,newRecInnerVisible:!1,topRecVisible:!1,showShuffle:!1,newRecForm:{newPlayerName:""},topRec:[],formLoading:!0,submitLoading:!1,lastRec:{}}),created(){this.getDate(),this.alpha=this.createAlpha(this.isShuffle),this.initAlpha()},mounted(){this.$refs.refInput.onpaste=function(){return!1}},computed:{upperCaseCurr(){return this.curr.toUpperCase()},showTopRec(){const e=this.topRec.filter((e=>e.isShuffle)),t=this.topRec.filter((e=>!e.isShuffle));return this.showShuffle?e:t}},watch:{inputVal(e,t){if(this.inputVal){const a=/^[A-Za-z]+$/.test(e);this.inputVal=a?e:t}},isShuffle(e){this.handleReset()},newRecVisible(e){setTimeout((()=>{this.$refs.refInput.blur()}),1)}},methods:{initTimer(){this.timer=setInterval((()=>{this.showTime=(.001*(Date.now()-this.startTime)).toFixed(3)}),1)},handleKeyup(e){if(/^[A-Za-z]+$/.test(e.key.toLowerCase()))if(e.key.toLowerCase()===this.curr){const e=Date.now();0===this.index&&(this.startTime=e,this.initTimer()),this.records.push({display:this.curr.toUpperCase(),currTime:((e-this.startTime)/1e3).toFixed(3)}),this.isLast?(this.curr="完成",clearInterval(this.timer),this.showTime=this.records.slice(-1)[0].currTime,this.newRecVisible=!0):this.initAlpha()}else e.preventDefault();else e.preventDefault()},handleReset(){this.inputVal="",this.alpha=null,this.alpha=this.createAlpha(this.isShuffle),this.initAlpha(),this.startTime="",this.records=[],clearInterval(this.timer),this.showTime=0},initAlpha(){const{val:e,index:t,isLast:a}=this.alpha();this.curr=e,this.index=t,this.isLast=a},createAlpha(e){let a=0,s=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];return s=e?t.shuffle(s):s,()=>{const e=s[a],t=a>=s.length-1;return{val:e,index:a++,isLast:t}}},handleRotate:t.throttle((function(){this.rotate=!0,setTimeout((()=>{this.rotate=!1}),1e3)}),1e3),getDate(){this.$moment.locale("zh-cn"),this.date=this.$moment().format("yyyy年M月d日 h:mm:ss"),setInterval((()=>{this.date=this.$moment().format("yyyy年M月d日 h:mm:ss")}),500)},onSubmitBtn(e){this.$refs[e].validate((async e=>{if(!e)return!1;{this.submitLoading=!0,this.topRec=await V();const e=this.topRec.some((e=>e.playerName===this.newRecForm.newPlayerName&&e.isShuffle===this.isShuffle));e?(console.log(e),this.newRecInnerVisible=!0,this.lastRec=this.topRec.filter((e=>e.playerName===this.newRecForm.newPlayerName&&e.isShuffle===this.isShuffle))[0]):(await this.submitRec(),this.submitLoading=!1)}}))},async onUpdateBtn(){this.newRecInnerVisible=!1,await this.submitRec(!0),this.submitLoading=!1},async submitRec(e){if(e)var t=await x(this.lastRec.id,this.showTime);else{const e={playerName:this.newRecForm.newPlayerName,record:parseFloat(this.showTime),isShuffle:this.isShuffle,createDate:Date.now()};t=await T(e)}200===t.code?(this.newRecVisible=!1,console.log(`${e?"更新":"添加"}成功:${t.id}`),a.success({message:(e?"更新":"添加")+"成功!",type:"success",duration:1e3,center:!0})):(console.log(t.err),a.error("提交失败!"))},async handleTopBtn(){this.topRecVisible=!0,this.topRec=await V(),this.formLoading=!1,this.showShuffle=this.isShuffle},formatRecord:e=>e.record+"s",formatcreateDate(e){return this.$moment(e.createDate).format("YY.MM.DD")},handleMaskClose(e){this.submitLoading=!1,e()},tableRowClassName({row:e,rowIndex:t}){switch(t){case 0:return"gold";case 1:return"silver";case 2:return"bronze"}}}},k=b("data-v-09ddc8da");s("data-v-09ddc8da");const C={class:"container"},L={class:"top"},D=c("h1",{class:"title vivify shake"},"Type Game",-1),I=c("h2",{class:"subtitle"},"输入字母，看看你的速度有多快 :)",-1),N=c("div",{class:"github"},[c("a",{href:"http://zoutianwei.github.io"},[c("img",{src:"/alpha-game/assets/github.307f2da5.png",alt:"github"})])],-1),F={class:"status"},_={class:"game"},$={class:"mode"},U=y("排行榜 🏆"),z=y(" 时间: "),A={class:""},M=y("s "),P={key:0,class:"result"},B=c("p",null,"成绩 🏁",-1),K=y(),j={class:"bottom"},q={class:"dialog-new"},Y={class:"dialog-inner"},O={style:{display:"flex","flex-direction":"column","align-items":"center"}},Q={style:{margin:"10px 0","font-size":"15px"}},E={style:{color:"#2EC4B6"}},Z={style:{margin:"10px 0","font-size":"20px"}},G=c("p",{style:{margin:"10px 0","font-size":"15px"}},"是否更新？",-1),H={class:"dialog-footer"},W=y("取 消"),X=y("更 新"),J={class:"wrap"},ee={style:{"margin-bottom":"10px"}},te={style:{}},ae={class:"dialog-footer"},se=y("取 消"),ie=y("确 定"),le={class:"dialog-top"},oe={style:{"text-align":"right"}},re=y(" > ");i();const ne=k(((e,t,a,s,i,b)=>{const v=l("el-switch"),g=l("el-button"),R=l("el-dialog"),V=l("el-input"),T=l("el-form-item"),x=l("el-form"),S=l("el-table-column"),ne=l("el-table"),ce=o("loading");return r(),n(p,null,[c("div",C,[c("div",L,[D,I,N,c("div",F,[c("p",{class:["msg",{"vivify spin duration-1000":"完成"===b.upperCaseCurr}]},d(b.upperCaseCurr),3)]),c("div",_,[h(c("input",{type:"text",class:"game-input","onUpdate:modelValue":t[1]||(t[1]=e=>i.inputVal=e),placeholder:"在这里输入",onKeydown:t[2]||(t[2]=(...e)=>b.handleKeyup&&b.handleKeyup(...e)),ref:"refInput",autocomplete:"off",autocapitalize:"off",spellcheck:"false"},null,544),[[u,i.inputVal,void 0,{trim:!0}]]),c("div",{class:["game-reset",{"vivify spin duration-1000":i.rotate}],onClick:t[3]||(t[3]=e=>{b.handleReset(),b.handleRotate()})}," Reset ",2)]),c("div",$,[c(v,{modelValue:i.isShuffle,"onUpdate:modelValue":t[4]||(t[4]=e=>i.isShuffle=e),"active-color":"#2ec4b6","inactive-color":"#e71d46","active-text":"随机","inactive-text":"顺序"},null,8,["modelValue"])]),c(g,{type:"warning",onClick:b.handleTopBtn},{default:k((()=>[U])),_:1},8,["onClick"]),c("div",{class:["timer",{"shake-little shake-constant":i.records.length}]},[z,c("span",A,d(i.showTime?i.showTime:"0.000"),1),M],2),c(m,{"enter-active-class":"vivify driveInTop duration-500","leave-active-class":"vivify driveOutTop duration-500"},{default:k((()=>[i.records.length?(r(),n("div",P,[B,c("ul",null,[(r(!0),n(p,null,f(i.records,((e,t)=>(r(),n("li",{key:`records-${t}`},[c("span",null,d(e.display)+": ",1),K,c("span",null,d(e.currTime)+"s",1)])))),128))])])):w("",!0)])),_:1})]),c("div",j,[c("p",null,d(i.date),1)])]),c("div",q,[c(R,{title:"记录一下",modelValue:i.newRecVisible,"onUpdate:modelValue":t[10]||(t[10]=e=>i.newRecVisible=e),width:"80%",center:"","before-close":b.handleMaskClose},{footer:k((()=>[c("span",ae,[c(g,{onClick:t[8]||(t[8]=e=>i.newRecVisible=!1)},{default:k((()=>[se])),_:1}),c(g,{type:"primary",onClick:t[9]||(t[9]=e=>b.onSubmitBtn("newRecForm")),loading:i.submitLoading},{default:k((()=>[ie])),_:1},8,["loading"])])])),default:k((()=>[c("div",Y,[c(R,{width:"80%",title:"更新成绩",modelValue:i.newRecInnerVisible,"onUpdate:modelValue":t[6]||(t[6]=e=>i.newRecInnerVisible=e),"append-to-body":"",center:"","before-close":b.handleMaskClose},{footer:k((()=>[c("span",H,[c(g,{onClick:t[5]||(t[5]=e=>{i.newRecInnerVisible=!1,i.submitLoading=!1})},{default:k((()=>[W])),_:1}),c(g,{type:"primary",onClick:b.onUpdateBtn},{default:k((()=>[X])),_:1},8,["onClick"])])])),default:k((()=>[c("div",O,[c("p",Q,[c("span",E,d(i.lastRec.playerName),1),y("上次榜单成绩是: "+d(i.lastRec.record)+"s ",1)]),c("p",Z," 本次成绩: "+d(i.showTime)+"s ",1),G])])),_:1},8,["modelValue","before-close"])]),c("div",J,[c("div",ee,d(i.isShuffle?"随机":"顺序")+"模式 ",1),c("div",te,"本次成绩: "+d(i.showTime)+"s",1),c(x,{model:i.newRecForm,ref:"newRecForm"},{default:k((()=>[c(T,{prop:"newPlayerName",rules:[{required:!0,message:"名字不能为空"},{max:5,message:"名字不能超过5个字符"}]},{default:k((()=>[c(V,{modelValue:i.newRecForm.newPlayerName,"onUpdate:modelValue":t[7]||(t[7]=e=>i.newRecForm.newPlayerName=e),placeholder:"请输入你的名字"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["modelValue","before-close"])]),c("div",le,[c(R,{title:"排行榜",modelValue:i.topRecVisible,"onUpdate:modelValue":t[12]||(t[12]=e=>i.topRecVisible=e),width:"90%","max-width":"100px",center:"","lock-scroll":""},{default:k((()=>[c("div",oe,[c(v,{modelValue:i.showShuffle,"onUpdate:modelValue":t[11]||(t[11]=e=>i.showShuffle=e),"active-color":"#2ec4b6","inactive-color":"#e71d46","active-text":"随机","inactive-text":"顺序"},null,8,["modelValue"])]),h(c(ne,{data:b.showTopRec,"default-sort":{prop:"record"},height:"50vh","row-class-name":b.tableRowClassName},{default:k((()=>[re,c(S,{type:"index",label:"排名"}),c(S,{property:"playerName",label:"玩家名称"}),c(S,{property:"record",label:"成绩",formatter:b.formatRecord},null,8,["formatter"]),c(S,{property:"createDate",label:"记录日期",formatter:b.formatcreateDate},null,8,["formatter"])])),_:1},8,["data","row-class-name"]),[[ce,i.formLoading]])])),_:1},8,["modelValue"])])],64)}));S.render=ne,S.__scopeId="data-v-09ddc8da";const ce=v(S);ce.config.globalProperties.$moment=g,ce.use(R),ce.mount("#app");
